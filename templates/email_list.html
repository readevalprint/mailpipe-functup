{% extends "base.html" %}

{% block content %}
  {% if detail %}
    <div class="alert alert-info">
      {{ detail }}
    </div>
  {% endif %}
  <div class="btn-group">
    {% if previous %}
      <a class="btn" href="{{ previous }}">Previous Page</a>
    {% endif %}
    {% if next %}
      <a class="btn" href="{{ next }}">Next Page</a>
    {% endif %}
  </div>


  {% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
      <div class="alert alert-danger" role="alert">
        {{ error }}
      </div>
    {% endfor %}
  {% endif %}

  {% if form.json.errors %}
    <div class="alert alert-danger" role="alert">
      {% for error in form.json.errors %}
        {{ error }}
      {% endfor %}
    </div>
  {% endif %}


  <form id="" action='' method=POST>
    {% for field in form %}
      <div class="fieldWrapper">
        {{ field }}
        {% if field.help_text %}
          <p class="help">{{ field.help_text|safe }}</p>
        {% endif %}
      </div>
    {% endfor %}
    {% csrf_token %}
    <button class="btn btn-primary" id='submit'>Create</button>
  </form>


  <table class="table table-hover">
    <thead>
      <tr>
        <th>Address</th>
        <th>Callback URL</th>
        <th>Inbox Size</th>
        <th>Messages</th>
      </tr>
    </thead>
    <tbody>
      {% for r in results %}
        <tr onclick="window.location='{{ r.messages }}';" class="clickableRow">
          <td>
            <a href="{{ r.url }}">{{ r.address }} </a>
          </td>
          <td>
            {{ r.callback_url | default:"None" }} 
          </td>
          <td>
            {{ r.messege_length_sum |filesizeformat }}
          </td>
          <td>
            <a href="{{ r.messages }}" >{{ r.message_count }} Message{{ r.message_count|pluralize }}</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  {% if not results %}
    <div class="alert alert-block alert-info">
      <h4>No inboxes yet</h4>
      Go ahead and create an inbox :D
    </div>
  {% endif %}
{% endblock %}

